---
title: "Are the mean and the standard deviation in EVI2 explained by the previous leaf flush classification from Dexter et al. (2018)?"
author: "Marcio Baldissera Cure"
date: "2/20/2023"
output: html_document
---

```{r include=T, echo=F, message=F, warning=F}
library(tidyverse)
completoRN <- read.table("/home/marcio/Documentos/Doutorado/Dexter/sentinel-2/tabela_completoRN.txt", h = T)
```

We performed linear models using R to test the *hypothesis* that *the previous leaf flush classification from Dexter et al. (2018) explains the mean and standard deviation (sd) in EVI2 time series*.

```{r include=T, echo=T}
model <- lm(sd_ndvi ~ Leaf_flush, data = completoRN)
```

```{r include=T, echo=T}
model1 <- lm(mean_ndvi ~ Leaf_flush, data = completoRN)
```


Models meet the assumption of homoscedasticity, normal distribution of residuals with a linear pattern and there is no influential observation (Figures 1 and 2).

```{r include=T, echo=F, fig.cap="Figure 1: Diagnostic plot for the model testing the EVI2 standard deviation."}
par(mfrow=c(2,2))
model %>% plot
```

```{r include=T, echo=F, fig.cap="Figure 2: Diagnostic plot for the model testing the mean EVI2."}
par(mfrow=c(2,2))
model1 %>% plot
```


## Model Parameters

Despite the significance of both models (Tables 1 and 3), their adjusted R-squared are low (~ 0.2) (Tables 2 and 4) and may be other factors also influencing the mean and standard deviation in EVI2.

### EVI2 standard deviation

```{r include=T, echo=F, fig.cap="Table 1: Model (sd EVI2 ~ leaf flush) parameters"}
broom::tidy(model, conf.int = TRUE)%>% data.table::data.table()
```

```{r include=T, echo=F, fig.cap=" Table 2: Summary information about the components of the model (sd EVI2 ~ leaf flush)"}
broom::glance(model)%>% data.table::data.table()
```


### Mean EVI2
```{r include=T, echo=F, fig.cap="Table 3: Model (sd EVI2 ~ leaf flush) parameters"}
broom::tidy(model1, conf.int = TRUE)%>% data.table::data.table()
```

```{r include=T, echo=F, fig.cap=" Table 4: Summary information about the components of the model (mean EVI2 ~ leaf flush)"}
broom::glance(model1)%>% data.table::data.table()
```


## Original data and fitted values from the model distributions

The statistical linear models used performed well and distributions of mean and standard deviations in EVI2 have the same pattern of the fitted values generated by the model (Figures 3-4).

### EVI2 standard deviation
```{r include=T, echo=F, fig.cap="Figure 3: EVI2 standard deviation from the original data and from the values fitted by the model."}
par(mfrow=c(1,2))
boxplot(completoRN$sd_ndvi ~ completoRN$Leaf_flush, main = "Data", ylim = c(0, 0.228), ylab = "sd EVI2", xlab = "Leaf flush")
boxplot(model$fitted.values ~ model$model$Leaf_flush, main = "Fitted", ylim = c(0, 0.228), ylab = NULL, xlab = "Leaf flush")
```


### Mean EVI2
```{r include=T, echo=F, fig.cap="Figure 4: Mean EVI2 from the original data and from the values fitted by the model."}
par(mfrow=c(1,2))
boxplot(completoRN$mean_ndvi ~ completoRN$Leaf_flush, main = "Data", ylim = c(0, 0.6), ylab = "mean EVI2", xlab = "Leaf flush")
boxplot(model1$fitted.values ~ model1$model$Leaf_flush, main = "Fitted", ylim = c(0, 0.6), ylab = NULL, xlab = "Leaf flush")
```

## Conclusion

We conclude that the leaf flush classification from Dexter et al. (2018) are able to explain EVI2 mean and the standard deviation in EVI2 for the sample points of the study.
